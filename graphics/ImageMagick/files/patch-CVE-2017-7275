From d94d85622f120f82240921ae7a83a72afcb79ddf Mon Sep 17 00:00:00 2001
From: Dirk Lemstra <dirk@git.imagemagick.org>
Date: Mon, 21 Nov 2016 20:54:14 +0100
Subject: [PATCH] Lowered max map_length to prevent an overflow (#271).

---
 coders/rle.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/coders/rle.c b/coders/rle.c
index 117bde8d51..a14fafa6c1 100644
--- coders/rle.c
+++ coders/rle.c
@@ -227,7 +227,7 @@ static Image *ReadRLEImage(const ImageInfo *image_info,ExceptionInfo *exception)
     bits_per_pixel=(size_t) ReadBlobByte(image);
     number_colormaps=(size_t) ReadBlobByte(image);
     map_length=(unsigned char) ReadBlobByte(image);
-    if (map_length >= 32)
+    if (map_length >= 22)
       ThrowReaderException(CorruptImageError,"ImproperImageHeader");
     one=1;
     map_length=one << map_length;
